{# templates/partials/announcements.html.twig #}

{# Define a map for status-specific Tailwind classes and Font Awesome icons #}
{% set statusStyles = {
    'scheduled': { 'icon': 'fa-solid fa-calendar-alt', 'bg': 'bg-blue-100', 'text': 'text-blue-800', 'border': 'border-blue-200' },
    'running': { 'icon': 'fa-solid fa-play-circle', 'bg': 'bg-green-100', 'text': 'text-green-800', 'border': 'border-green-200' },
    'submissions_ended': { 'icon': 'fa-solid fa-hourglass-end', 'bg': 'bg-orange-100', 'text': 'text-orange-800', 'border': 'border-orange-200' },
    'winners_announced': { 'icon': 'fa-solid fa-trophy', 'bg': 'bg-yellow-100', 'text': 'text-yellow-800', 'border': 'border-yellow-200' },
    'cancelled': { 'icon': 'fa-solid fa-circle-xmark', 'bg': 'bg-red-100', 'text': 'text-red-800', 'border': 'border-red-200' },
    'default': { 'icon': 'fa-solid fa-info-circle', 'bg': 'bg-gray-100', 'text': 'text-gray-700', 'border': 'border-gray-200' }
} %}

<div id="global-announcements" class="announcements-section container mx-auto px-4 py-3 mb-6 bg-white rounded-lg shadow-md border border-gray-200">
    {% if announcements is not empty %}
        <h4 class="text-xl font-semibold text-gray-800 mb-3 border-b pb-2 border-gray-200">Latest Announcements</h4>
        
        <ul id="announcements-list"
            class="list-none p-0 m-0
                   grid grid-cols-1 {% if announcements|length > 5 %}md:grid-cols-2 md:gap-x-4{% endif %} gap-y-3">
            {% for announcement in announcements %}
                {# Get the style for the current announcement's status, fallback to 'default' #}
                {% set currentStatusStyle = statusStyles[announcement.status|default('default')] ?? statusStyles.default %}

                <li class="p-3 rounded-md flex items-start gap-3 text-sm leading-tight transition-all duration-300 ease-in-out
                           {{ currentStatusStyle.bg }} {{ currentStatusStyle.text }} {{ currentStatusStyle.border }} hover:bg-opacity-80 border"
                    data-timestamp="{{ announcement.timestamp }}"
                    data-status="{{ announcement.status|default('default') }}">
                    
                    <span class="flex-shrink-0 inline-flex items-center justify-center h-6 w-6 rounded-full {{ currentStatusStyle.text }} text-white">
                        <i class="{{ currentStatusStyle.icon }} text-blue-500 mr-2"></i>
                    </span>

                    {# Div to contain message and timestamp, stacked vertically #}
                    <div class="flex-grow flex flex-col">
                        {# Announcement message text will now inherit the currentStatusStyle.text color from the <li> #}
                        <strong class="font-semibold">{{ announcement.message }}</strong>
                        <small class="text-gray-500 text-xs mt-0.5">({{ announcement.timestamp|date('F j, Y, g:i a') }})</small>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-center text-gray-600 text-base py-4 no-announcements-message">No announcements yet.</p>
    {% endif %}
</div>