{% extends 'base.html.twig' %}

{% block title %}Ενεργοί Διαγωνισμοί{% endblock %}

{% block body %}
    <h1>Ενεργοί Διαγωνισμοί</h1>

    {% if competitions is empty %}
        <p>Δεν υπάρχουν ενεργοί διαγωνισμοί αυτή τη στιγμή.</p>
    {% else %}
        <ul>
            {% for competition in competitions %}
                <li>
                    {% include 'public/_competition_item.html.twig' with {'competition': competition} %}
                    <p><a href="{{ path('public_competition_submit', {'id': competition.id}) }}">Δήλωση Συμμετοχής</a></p>
                </li>
            {% endfor %}
        </ul>
    {% endif %}


<script type="text/javascript">
    const mercureTopic = `http://example.com/books/1`;

    const eventSource = new EventSource(`https://symfony.localhost/.well-known/mercure?topic=${mercureTopic}`);

    eventSource.onmessage = (event) => {
        console.log("Received Mercure update for book:", JSON.parse(event.data));
        // alert("Niaouuu", JSON.parse(event.data));
        // You might update a specific part of the page here, e.g.:
        document.getElementById('competition-7').innerText = JSON.parse(event.data).status;
    };
</script>
{% endblock %}
